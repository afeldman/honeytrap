version: v1
policies:
  - name: sql_injection_patterns
    description: "Erkenne offensichtliche SQLi-Muster"
    priority: 80
    conditions:
      any:
        - protocol: "http"
          request_path_contains:
            - "id="
            - "user="
          payload_regex:
            - "(?i)(or 1=1)"
            - "(?i)union select"
            - "(?i)information_schema"
    action:
      type: DECEPTION
      deception_profile: "http-db-fake"
      log: true

  - name: brute_force_ssh
    description: "Mehrere fehlgeschlagene SSH-Logins in kurzer Zeit"
    priority: 90
    conditions:
      any:
        - protocol: "ssh"
          failed_logins_last_60s_gte: 5
    action:
      type: BLOCK
      log: true
      reason: "SSH brute force detected"
